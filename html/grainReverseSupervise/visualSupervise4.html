<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>库存追溯（廒间）</title>
    <!--<link rel="stylesheet" href="../../plug-in/bootstrap/css/bootstrap.min.css">-->
    <!--<link rel="stylesheet" href="../../plug-in/easyui/themes/skin1/easyui.css">-->
    <script src="../../plug-in/jquery-1.10.2.min.js"></script>
    <script src="../../resource/common_js/common.js"></script>
    <!-- 树插件 -->
    <link rel="stylesheet" href="../../plug-in/ztree/css/zTreeStyle.css" type="text/css">
    <script type="text/javascript" src="../../plug-in/ztree/js/jquery.ztree.core-3.5.min.js"></script>
    <script type="text/javascript" src="../../plug-in/ztree/js/jquery.ztree.excheck-3.5.min.js"></script>
    <script type="text/javascript" src="../../plug-in/ztree/js/jquery.ztree.exhide.min.js"></script>
    <script type="text/javascript" src="../../plug-in/ztree/js/ztreeCreator.js"></script>

    <!--layui样式-->
    <link rel="stylesheet" href="../../plug-in/layui/css/layui.css">
    <link rel="stylesheet" href="../../plug-in/layui_ext/dtree/dtree.css">
    <link rel="stylesheet" href="../../plug-in/layui_ext/dtree/font/dtreefont.css">
    <!-- 自定义样式 -->
    <link rel="stylesheet" href="../../resource/css/style.css">
    <!--以layui为基础改的样式-->
    <link rel="stylesheet" href="../../resource/css/style-layui.css">

</head>
<body>
<div class="top-box">
    <div class="top-box-title">
        <div class="top-box-line1"></div>
        <div class="top-box-line2"></div>
        <div class="top-box-line3"></div>
        <div class="top-box-line4"></div>
        <div class="top-title-inner">
            <div class="top-box-title-center">
                <a id="toggleTree"><span id="nameSpan">广西南宁储备粮库</span> <i class="layui-edge"></i></a>
            </div>
        </div>
    </div>
    <div class="top-box-content">
        <div class="clearfix top-box-inner">
            <div class="count-box">
                <div style="display: inline-block;">
                    <div class="count-icon-outer"><i class="count-icon c-icon1"></i></div>
                    <div class="count-info">
                        <p><span>123.8 </span>kg</p>
                        <p>总库存数量</p>
                    </div>
                </div>
            </div>
            <div class="count-box">
                <div style="display: inline-block;">
                    <div class="count-icon-outer"><i class="count-icon c-icon2"></i></div>
                    <div class="count-info">
                        <p><span>123.8 </span>kg</p>
                        <p>总入库数量</p>
                    </div>
                </div>
            </div>
            <div class="count-box">
                <div style="display: inline-block;">
                    <div class="count-icon-outer"><i class="count-icon c-icon3"></i></div>
                    <div class="count-info">
                        <p><span>123.8 </span>kg</p>
                        <p>总出库数量</p>
                    </div>
                </div>
            </div>
            <div class="count-box">
                <div style="display: inline-block;">
                    <div class="count-icon-outer"><i class="count-icon c-icon4"></i></div>
                    <div class="count-info">
                        <p><span>123.8 </span>kg</p>
                        <p>总溢余数量</p>
                    </div>
                </div>
            </div>
            <div class="count-box">
                <div style="display: inline-block;">
                    <div class="count-icon-outer"><i class="count-icon c-icon5"></i></div>
                    <div class="count-info">
                        <p><span>123.8 </span>kg</p>
                        <p>总损失数量</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="mt15">
    <div class="each-tab"><a href="visualSupervise1.html"><i class="tab-icon tab-icon1"></i>可视化监管</a></div>
    <div class="each-tab"><a href="visualSupervise2.html"><i class="tab-icon tab-icon2"></i>储备粮监管</a></div>
    <div class="each-tab"><a href="visualSupervise3.html"><i class="tab-icon tab-icon3"></i>库存追溯（执行文件）</a></div>
    <div class="each-tab active"><a href="visualSupervise4.html"><i class="tab-icon tab-icon4"></i>库存追溯（廒间）</a></div>
</div>
<div class="layui-card">
    <div class="layui-card-body">
        <form class="layui-form label-auto-width" action="" lay-filter="example">
            <div class="layui-form-item layui-inline">
                <label class="layui-form-label">廒间号：</label>
                <div class="layui-input-block w140">
                    <select name="type">
                        <option value="">全部</option>
                        <option value="1号厫间">1号厫间</option>
                        <option value="2号厫间">2号厫间</option>
                        <option value="3号厫间">3号厫间</option>
                        <option value="4号厫间">4号厫间</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item layui-inline ml20">
                <label class="layui-form-label">时间：</label>
                <div class="layui-input-block">
                    <a class="select-btn">10年</a>
                    <a class="select-btn">5年</a>
                    <a class="select-btn">1年</a>
                    <div class="layui-inline"><input type="text" class="layui-input input-date w140" placeholder="自定义时间"></div>
                </div>
            </div>
            <!--<div class="layui-form-item layui-inline last-item">-->
                <!--<button class="layui-btn search-btn ml10" type="button">查询</button>-->
            <!--</div>-->
        </form>
        <table id="table" lay-filter="demo" class="layui-hide">
        </table>
    </div>
</div>
<div id="treePop" class="tree-pop">
    <div style="max-height: 600px;overflow: auto;">
        <ul id="treeDemo" class="ztree"></ul>
    </div>
</div>
<script type="text/html" id="barDemo">
    <a class="op-word" lay-event="supervise">监管</a>
</script>
<script src="../../plug-in/layui/layui.js" charset="utf-8"></script>
<script src="../../plug-in/layui/lay/modules/layerExtend.js" type="text/javascript"></script>
<script src="../../plug-in/layui/lay/modules/tableExtend.js" type="text/javascript"></script>
<script>
    layui.extend({
        dtree: '../../plug-in/layui_ext/dtree/dtree'   // {/}的意思即代表采用自有路径，即不跟随 base 路径
    }).use(['form', 'layedit', 'laydate','table','element','upload','dtree'], function(){
        var form = layui.form
            ,layer = layui.layer
            ,table = layui.table
            ,element = layui.element
            ,$ = layui.jquery
            ,upload = layui.upload
            ,dtree = layui.dtree
            ,laydate = layui.laydate;

        lay('.input-date').each(function(){
            laydate.render({
                elem: this
                ,trigger: 'click'
            });
        });
        var myTree = dtree.render({
            elem: "#treeDemo",
            url: "../../resource/json/dataTree.json",
            initLevel: 5,
            line: true,  // 显示树线
            nodeIconArray:{"3":{}},  // 自定扩展的二级非最后一级图标，从1开始
            leafIconArray:{"11":"dtree-icon-location"},  // 自定义扩展的二级最后一级图标，从11开始
            icon: ["3","11"], // 使用
            skin: "laySimple"  // layui主题风格
        });
        // 绑定节点的双击
        dtree.on("node('treeDemo')", function(obj){
            if(obj.childParams.length === 0){
                $("#nameSpan").text(obj.param.context);
                hideSelect();
            }
        });

        $("#toggleTree").click(function (e) {
            var cityOffset = $(this).offset();
            var left = cityOffset.left - $("#treePop").width()/2 + $(this).outerWidth()/2;
            $("#treePop").css({
                left:left + "px",
                top:cityOffset.top + $(this).outerHeight() + 15 + "px"
            }).slideToggle("fast");
            $("body").bind("mousedown", onBodyDown);
        });

        var data = [];
        for(var i = 0; i < 22; i++){
            var tmp = {
                name1: i+1,
                name2: i+1,
                name3: '稻谷',
                name4: '自治区人民政府',
                name5: '自治区储备粮',
                name6: '3030吨',
                name7: '仓馁散储',
                name8: '2016.11',
                name9: '2016',
                name10: 'XX',
                name11: '三等',
                name12: '57.2',
                name13: '57',
                name14: '57',
                name15: '57',
                name16: '57',
                name17: '57',
                name18: '57'
            };
            data.push(tmp);
        }
        $.tableRender({
            elem: '#table'
            // ,data: data
            // 静态json不支持表格自带分页
            ,url:'../../resource/json/grainReverseSupervise/visualSupervise4.json'
            ,cols: [[ //标题栏
                // {type: 'checkbox',width:60}
                {field: 'name1',rowspan: '2', title: '货位编号'}
                ,{field: 'name2',rowspan: '2', title: '厫间号'}
                ,{field: 'name3',rowspan: '2', title: '品种'}
                ,{field: 'name4',rowspan: '2', title: '粮权归属'}
                ,{field: 'name5',rowspan: '2', title: '粮油性质'}
                ,{field: 'name6',rowspan: '2', title: '数量'}
                ,{colspan: '8', title: '本期质量情况'}
                ,{field: 'name7',rowspan: '2', title: '储存方式'}
                ,{field: 'name8',rowspan: '2', title: '入库时间'}
                ,{field: 'name9',rowspan: '2', title: '收获年份'}
                ,{field: 'name10',rowspan: '2', title: '保管员'}
                ,{field: 'op',rowspan: '2', title: '操作', toolbar: '#barDemo'}
            ],
                [
                    {field: 'name11', title: '等级'}
                    ,{field: 'name12', title: '水分'}
                    ,{field: 'name13', title: '杂质'}
                    ,{field: 'name14', title: '容量'}
                    ,{field: 'name15', title: '出糙率'}
                    ,{field: 'name16', title: '整精米率'}
                    ,{field: 'name17', title: '面筋吸水量'}
                    ,{field: 'name18', title: '脂肪酸值'}
                ]]
        });
        //监听工具条
        table.on('tool(demo)', function(obj){
            if(obj.event === 'supervise'){
                selectLink();
            }
        });

    });
    function selectLink() {
        var param = {
            area:["700px","350px"],
            // shade: 0.1,
            shadeClose: true
        };
        param.content = '<div style="margin-left: 20px;margin-top: 15px;">\n' +
            '    <a class="supervise-link" href="storageSupervise.html">\n' +
            '        <i class="supervise-link-icon icon1"></i>\n' +
            '        <p>库存监管</p>\n' +
            '    </a>\n' +
            '    <a class="supervise-link" href="qualitySSupervise.html">\n' +
            '        <i class="supervise-link-icon icon2"></i>\n' +
            '        <p>质量监管</p>\n' +
            '    </a>\n' +
            '    <a class="supervise-link" href="inAndOutSupervise.html">\n' +
            '        <i class="supervise-link-icon icon3"></i>\n' +
            '        <p>移库监管</p>\n' +
            '    </a>\n' +
            '    <a class="supervise-link" href="changeSupervise.html">\n' +
            '        <i class="supervise-link-icon icon4"></i>\n' +
            '        <p>粮油性质变更监管</p>\n' +
            '    </a>\n' +
            '    <a class="supervise-link" href="statusSupervise.html">\n' +
            '        <i class="supervise-link-icon icon5"></i>\n' +
            '        <p>粮情监管</p>\n' +
            '    </a>\n' +
            '    <a class="supervise-link" href="iOSupervise.html">\n' +
            '        <i class="supervise-link-icon icon6"></i>\n' +
            '        <p>出入库监管</p>\n' +
            '    </a>\n' +
            '</div>';
        $.layerContent02(param);
    }
    function onBodyDown(event) {
        if (!(event.target.id == "treePop" || $(event.target).parents("#treePop").length>0)) {
            hideSelect();
        }
    }
    function hideSelect() {
        $("#treePop").fadeOut("fast");
        $("body").unbind("mousedown", onBodyDown);
    }
</script>
</body>
</html>